apply plugin: 'java'
apply plugin: 'maven-publish'

def utf8 = 'UTF-8'
def java = '11'

repositories {
	mavenCentral()
}

dependencies {
	testImplementation 'junit:junit:+'
	testImplementation 'org.assertj:assertj-core:+'
	testImplementation 'org.junit.jupiter:junit-jupiter-engine:+'
	testImplementation 'org.junit.jupiter:junit-jupiter-params:+'
}

compileJava {
	options.encoding = utf8
	sourceCompatibility = java
	targetCompatibility = java
}

test {
	useJUnitPlatform()
}

javadoc {
	exclude 'qxsl/extra/**'
	options.links("https://docs.oracle.com/en/java/javase/$java/docs/api/")
	options.header("<a href='http://nextzlog.github.io/qxsl'>QxSL API</a>")
	options.charSet = utf8
	options.encoding = utf8
}

publishing.publications {
	qxsl(MavenPublication) {
		from components.java
		groupId = 'qxsl'
		def ver = 'git describe'.execute().text.trim()
		version = ver?.split("-", 3).take(2).join(".")
	}
}

publishing.repositories.maven{url = "$buildDir/mvn"}
